<div class="bg-card text-card-foreground p-0">
  <ng-container *ngIf="post$ | async as post; else loading">
    <div class="flex justify-between items-center p-6 border-b border-border">
      <h2 mat-dialog-title class="font-heading text-2xl mb-0">{{ post.titulo }}</h2>
      <button mat-icon-button (click)="close()" aria-label="Fechar di치logo">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <mat-dialog-content class="py-6 px-6 max-h-[60vh] overflow-y-auto">
      <div class="prose prose-sm md:prose-base max-w-none text-card-foreground">
        <p>{{ post.descricao }}</p>
        <div class="text-sm text-muted-foreground mt-4">
          <span>{{ post.nomeUsuario }}</span> |
          <span>{{ post.criadoEm | date:'fullDate' }}</span> |
          <span class="px-2 py-1 text-xs font-semibold text-secondary-foreground bg-secondary rounded-full">{{
            post.categoria }}</span>
        </div>
      </div>

      <div class="mt-8">
        <h3 class="text-lg font-bold font-heading border-b border-border pb-2 mb-4">Coment치rios</h3>
        <div *ngIf="post.comentarios && post.comentarios.length > 0; else noComments" class="space-y-4">
          <div *ngFor="let comment of post.comentarios" class="flex items-start space-x-3">
            <div
              class="flex-shrink-0 w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold">
              {{ comment.nomeUsuario.charAt(0) }}
            </div>
            <div class="flex-1 p-3 bg-muted rounded-lg">
              <p class="font-semibold text-sm">{{ comment.nomeUsuario }}</p>
              <p class="text-sm">{{ comment.conteudo }}</p>
              <p class="text-xs text-muted-foreground mt-1 text-right">{{ comment.criadoEm | date:'short' }}</p>
            </div>
          </div>
        </div>
        <ng-template #noComments>
          <p class="text-sm text-muted-foreground">Nenhum coment치rio ainda. Seja o primeiro!</p>
        </ng-template>
      </div>
    </mat-dialog-content>

    <mat-dialog-actions align="end" class="p-6 border-t border-border">
      <form [formGroup]="commentForm" (ngSubmit)="addComment()" class="w-full flex items-center gap-3">
        <mat-form-field class="flex-1" appearance="outline">
          <mat-label>Seu coment치rio</mat-label>
          <input matInput formControlName="conteudo" cdkFocusInitial>
        </mat-form-field>
        <button mat-flat-button color="primary" type="submit" [disabled]="commentForm.invalid">Enviar</button>
      </form>
    </mat-dialog-actions>
  </ng-container>

  <ng-template #loading>
    <div class="p-8 text-center text-muted-foreground">Carregando detalhes...</div>
  </ng-template>
</div>